"use strict";angular.module("mecanexAdminApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.router","ui.bootstrap","underscore","angular.filter","forerunnerdb","angular-underscore","xml"]).config(["$stateProvider","$urlRouterProvider","USER_ROLES",function(a,b,c){b.otherwise("/collections/list"),a.state("login",{"abstract":!0,views:{"":{templateUrl:"views/pages/login.html"}},data:{authorizedRoles:[c.all]}}).state("login.default",{url:"/login",views:{"":{templateUrl:"views/login.default.html"}},data:{authorizedRoles:[c.all]}}).state("login.not-allowed",{url:"/not-allowed",templateUrl:"views/pages/not-allowed.html",data:{authorizedRoles:[c.all]}}).state("login.logout",{url:"/logout",templateUrl:"views/pages/logged-out.html",data:{authorizedRoles:[c.all]}}).state("pages",{"abstract":!0,views:{"":{templateUrl:"views/pages/default.html"}},data:{authorizedRoles:[c.all]}}).state("pages.list-collections",{url:"/collections/list",controller:"CollectionsListCtrl",templateUrl:"views/collections.list.html",data:{authorizedRoles:[c.admin,c.user]}}).state("pages.view-collection",{url:"/collections/view/:colId",controller:"CollectionViewCtrl",templateUrl:"views/collection.view.html",data:{authorizedRoles:[c.admin,c.user]}}).state("pages.edit-collection",{"abstract":!0,url:"/collections/edit/:editColId",views:{"":{templateUrl:"views/collections.edit.html"}},data:{authorizedRoles:[c.admin,c.user]}}).state("pages.edit-collection.default",{url:"",views:{"":{templateUrl:"views/collections.edit.list.html",controller:"CollectionsCarouselCtrl"},list:{templateUrl:"views/videos.list.html",controller:"VideosListCtrl"}},data:{authorizedRoles:[c.admin,c.user]}}).state("pages.edit-collection.other-collection",{url:"/other/:colId",views:{"":{templateUrl:"views/collections.edit.list.html",controller:"CollectionsCarouselCtrl"},list:{templateUrl:"views/videos.list.html",controller:"VideosListCtrl"}},data:{authorizedRoles:[c.admin,c.user]}}).state("pages.content-enrichments",{url:"/collections/:colId/video/:vidId/content-enrichments",views:{"":{templateUrl:"views/content.enrichments.html",controller:"ContentEnrichmentsCtrl"}},data:{authorizedRoles:[c.admin,c.user]}}).state("pages.editorial-tool",{url:"/collections/:colId/video/:vidId/editorial-tool",views:{"":{templateUrl:"views/editorial.tool.html",controller:"EditorialToolCtrl"}},data:{authorizedRoles:[c.admin,c.user]}})}]).run(["$rootScope","AUTH_EVENTS","AuthService","$state",function(a,b,c,d){a.$on("$stateChangeStart",function(e,f){var g=f.data.authorizedRoles;c.isAuthorized(g)||(e.preventDefault(),c.isAuthenticated()?(d.go("login.not-allowed"),a.$broadcast(b.notAuthorized)):(d.go("login.default"),a.$broadcast(b.notAuthenticated)))})}]),angular.module("mecanexAdminApp").constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}),angular.module("mecanexAdminApp").constant("USER_ROLES",{all:"*",admin:"admin",user:"user",editor:"editor",guest:"guest"}),angular.module("mecanexAdminApp").constant("INGEST_STEPS",{annotation:{name:"Annotations",icon:"annotation",processed:!1,file:""},enrichment:{name:"Content Enrichment Tool",icon:"enrichment",processed:!1,file:"",url:""},editorial:{name:"Editorial Tool",icon:"editorial",processed:!1,file:""}}),angular.module("mecanexAdminApp").constant("VIDEO_CATEGORIES",{arts:{name:"Arts and culture",icon:"arts"},disasters:{name:"Disasters",icon:"disasters"},education:{name:"Education",icon:"education"},environment:{name:"Environment and Nature",icon:"environment"},health:{name:"Health",icon:"health"},lifestyle:{name:"Lifestyle and consumerism",icon:"lifestyle"},media:{name:"The Media",icon:"media"},holidays:{name:"National holidays, festivals, anniversaries, annual events",icon:"holidays"},politics:{name:"Politics and economics",icon:"politics"},religion:{name:"Religion and belief",icon:"religion"},society:{name:"Society and social issues",icon:"society"},transportation:{name:"Transportation, science and technology",icon:"transportation"},wars:{name:"Wars and conflict",icon:"wars"},work:{name:"Work and production",icon:"work"}}),angular.module("mecanexAdminApp").factory("AuthService",["$http","Session","_","chance","$q",function(a,b,c,d,e){var f={},g=[{username:"admin@mecanex.nl",smithersId:"test-admin",password:"admin123",role:"admin"},{username:"guest@mecanex.nl",smithersId:"test-guest",password:"guest123",role:"guest"},{username:"user@mecanex.nl",smithersId:"test-user",password:"user123",role:"user"},{username:"pieter@noterik.nl",smithersId:"pieter",password:"pieter123",role:"user"},{username:"kemal@flyingeye.de",smithersId:"kemal",password:"kemal123",role:"user"},{username:"fokus@mecanex.eu",smithersId:"fokus",password:"fokus123",role:"user"},{username:"vci@mecanex.eu",smithersId:"vci",password:"vci123",role:"user"},{username:"luce@mecanex.eu",smithersId:"luce",password:"luce123",role:"user"},{username:"flyingeye@mecanex.eu",smithersId:"flyingeye",password:"flyingeye123",role:"user"},{username:"iccs@mecanex.eu",smithersId:"iccs",password:"iccs123",role:"user"},{username:"bob@noterik.nl",smithersId:"bob",password:"bobbob",role:"user"},{username:"alice@noterik.nl",smithersId:"alice",password:"alicealice",role:"user"}];return f.login=function(a){var f=c.find(g,function(b){return b.username===a.username&&b.password===a.password});return e(function(a,c){if(f){var e=b.create(d.guid(),f.username,f.role,f.smithersId);a(e)}else c()})},f.isAuthenticated=function(){return!!b.get("userId")},f.isAuthorized=function(a){return angular.isArray(a)||(a=[a]),-1!==a.indexOf("*")?!0:a.indexOf(b.get("userRole"))>0?!0:!1},f}]),angular.module("mecanexAdminApp").service("Session",["$cookies",function(a){var b={};return a.getObject("session")&&(b=a.getObject("session")),{create:function(c,d,e,f){b.sessionId=c,b.userId=d,b.userRole=e,b.smithersId=f,a.putObject("session",b)},destroy:function(){b={},a.remove("session")},get:function(a){return b[a]}}}]),angular.module("mecanexAdminApp").factory("SpringfieldResource",["Fsxml","$resource",function(a,b){var c="http://mecanex.noterik.com/bart/",d=0,e=-1,f=0;return function(){return{create:function(g,h,i,j,k){return"bart"===h&&(f=void 0===i?f:i,d=void 0===j?d:j,e=void 0===k?e:k,g=c+g+"?start="+d+"&limit="+e+"&depth="+f),b(g,{id:"@_id"},{save:{method:"POST",transformRequest:function(b){var c=new a;return c.renderFromResource(b)},transformResponse:function(b){var c=new a;return c.parseFromFsxml(b)},headers:{Accept:"text/xml","Content-Type":"text/xml;charset=utf-8"}},update:{method:"PUT",url:g+"/properties",transformRequest:function(b){var c=new a;return c.renderFromResource(b)},transformResponse:function(b){var c=new a;return c.parseFromFsxml(b)},headers:{Accept:"text/xml","Content-Type":"text/xml;charset=utf-8"}},retrieve:{method:"GET",transformResponse:function(b){var c=new a;return c.parseFromFsxml(b)},headers:{Accept:"text/xml","Content-Type":"text/xml;charset=utf-8"}},remove:{method:"DELETE",transformResponse:function(b){var c=new a;return c.parseFromFsxml(b)},headers:{Accept:"text/xml","Content-Type":"text/xml;charset=utf-8"}}})}}}}]),angular.module("mecanexAdminApp").factory("Users",["SpringfieldResource",function(a){var b=new a;return b.create("/users/:id")}]),angular.module("mecanexAdminApp").factory("chance",["$window",function(a){return new a.Chance}]),angular.module("mecanexAdminApp").factory("Fsxml",["X2JS",function(a){return function(){function b(){return(new DOMParser).parseFromString("<fsxml></fsxml>","text/xml")}return{renderFromResource:function(a){var c=b(),d=c.getElementsByTagName("fsxml")[0];if(a.properties){var e=c.createElement("properties");d.appendChild(e),angular.forEach(a.properties,function(a){angular.forEach(a,function(a,b){var d=c.createElement(b);d.textContent=a,e.appendChild(d)})})}else if(a.attributes){var f=c.createElement("attributes");d.appendChild(f),angular.forEach(a.attributes,function(a){angular.forEach(a,function(a,b){var d=c.createElement(b);d.textContent=a,f.appendChild(d)})})}else c=a;return c},parseFromFsxml:function(b){var c=new a,d=c.xml_str2json(b);return d}}}}]),angular.module("mecanexAdminApp").factory("RandomData",["chance","$q","$fdb","_","INGEST_STEPS","VIDEO_CATEGORIES",function(a,b,c,d,e,f){function g(b){var c=3e5,d=36e5;return function(){return{_id:a.guid(),name:a.sentence({words:a.integer({min:1,max:5})}),description:a.sentence({words:a.integer({min:30,max:100})}),img:"https://unsplash.it/320/180/?random&i="+a.integer({min:10,max:20}),categories:a.pickset(b,a.integer({min:1,max:b.length})),steps:p.slice(0,a.integer({min:0,max:p.length})),duration:a.integer({min:c,max:d})}}}function h(){var b=a.integer({min:50,max:150}),c=a.integer({min:1,max:5}),e=a.pickset(q,c),f=a.n(g(e),b),h=a.guid();f=d.map(f,function(a){return a.colId=h,a});var i=d.union.apply({},d.map(f,function(a){return d.map(a.categories,function(a){return a.name})}));return{collection:{_id:h,name:a.sentence({words:a.integer({min:1,max:5})}),img:"https://unsplash.it/320/180/?random&i="+a.integer({min:10,max:20}),description:a.paragraph(),amountVideos:f.length,categories:i,created:new Date},videos:f}}function i(){return{name:a.sentence({words:a.integer({min:1,max:5})}),description:a.sentence({words:a.integer({min:30,max:100})}),img:"https://unsplash.it/320/180/?random&i="+a.integer({min:10,max:20})}}var j=a.integer({min:20,max:50}),k=a.integer({min:50,max:150}),l=c.db("Mecanex"),m=l.collection("random-collections"),n=l.collection("random-collection-videos"),o=l.collection("external-videos"),p=d.values(e),q=d.values(f),r=a.n(h,j);a.n(i,k);m.insert(d.map(r,function(a){return a.collection}));for(var s=[],t=d.map(r,function(a){return a.videos}),u=0;u<t.length;u++)s=s.concat(t[u]);return n.insert(s),{queryCollections:function(a){a=a?a:{};var b=a.query?a.query:{},c=a.settings?a.settings:{page:1,limit:10},d=m.find(b,{$page:c.page-1,$limit:c.limit,$orderBy:{created:-1}});return{totalItems:d.$cursor.records?d.$cursor.records:d.length,itemsPerPage:c.limit,page:c.page,items:d}},queryCollectionVideos:function(a){a=a?a:{};var b=a.query?a.query:{},c=a.settings?a.settings:{page:1,limit:10},d=n.find(b,{$page:c.page-1,$limit:c.limit});return{totalItems:d.$cursor.records?d.$cursor.records:d.length,itemsPerPage:c.limit,page:c.page,items:d}},queryExternalVideos:function(a){a=a?a:{};var b=a.query?a.query:{},c=a.settings?a.settings:{page:1,limit:10},d=o.find(b,{$page:c.page-1,$limit:c.limit});return{totalItems:d.$cursor.records?d.$cursor.records:d.length,itemsPerPage:c.limit,page:c.page,items:d}}}}]),angular.module("mecanexAdminApp").filter("trusted",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]),angular.module("mecanexAdminApp").filter("reverse",function(){return function(a){return a.slice().reverse()}}),angular.module("mecanexAdminApp").filter("joinBy",function(){return function(a,b){return a.join(b)}}),angular.module("mecanexAdminApp").factory("ExternalVideos",["$q","$fdb","SpringfieldResource","_","INGEST_STEPS","VIDEO_CATEGORIES",function(a,b,c,d,e,f){function g(b,c){return a(function(a){h(b*c,c).then(function(b){var c=i(b);a(c)})})}function h(a,b){return k.create(n,"bart",1,a,b).retrieve().$promise.then(function(a){return a})}function i(a){var b=[];return a.fsxml.properties.totalResultsAvailable!==m&&(m=a.fsxml.properties.totalResultsAvailable),angular.forEach(a.fsxml.video,function(a){var c=[];angular.copy(o,c),void 0!==a.properties.annotationsfile&&(c[0].processed=!0,c[0].file=a.properties.annotationsfile),void 0!==a.properties.enrichmentsfile&&void 0!==a.properties.editenrichmenturl&&(c[1].processed=!0,c[1].file=a.properties.enrichmentsfile,c[1].url=a.properties.editenrichmenturl),b.push({_id:a._id,name:a.properties.TitleSet_TitleSetInEnglish_title,description:a.properties.summaryInEnglish,img:a.properties.screenshot,refer:n+a._id,categories:void 0===a.properties.categories?[]:j(a.properties.categories.split(",")),duration:a.properties.TechnicalInformation_itemDuration,steps:c,colId:-1})}),b}function j(a){var b=[];return angular.forEach(a,function(a){for(var c=0;c<p.length;c++)if(p[c].icon===a){b.push(p[c]);break}}),b}var k=new c,l=b.db("Mecanex"),m=(l.collection("external-videos"),0),n="/domain/mecanex/user/luce/video/",o=d.values(e),p=d.values(f);return{query:function(b){b=b?b:{};var c=(b.query?b.query:{},b.settings?b.settings:{page:0,limit:10}),d=a.defer();return g(c.page-1,c.limit).then(function(a){d.resolve({totalItems:m,itemsPerPage:c.limit,page:c.page,items:a})}),d.promise}}}]),angular.module("mecanexAdminApp").factory("CollectionVideos",["Collections","$q",function(a,b){return{query:function(c){return b(function(b){b(a.queryVideos(c))})}}}]),angular.module("mecanexAdminApp").factory("Collections",["chance","$q","$fdb","$state","SpringfieldResource","_","Session","INGEST_STEPS","VIDEO_CATEGORIES",function(a,b,c,d,e,f,g,h,i){function j(){return b(function(a){l().then(function(b){k(b),a()})})}function k(b){var c=[],d=[],e=b.fsxml.collection;if(!angular.isArray(e)){var g=[];g.push(e),e=g}angular.forEach(e,function(b){var d=m(b.video,b._id),e=f.union.apply({},f.map(d,function(a){return f.map(a.categories,function(a){return a.name})}));c.push({collection:{_id:b._id,name:b.properties.title,description:b.properties.description,amountVideos:d.length,img:d.length>0?d[0].img:"images/collections/no-thumb.451751f3.png",categories:e,steps:u.slice(0,a.integer({min:0,max:u.length}))},videos:d})}),r.insert(f.map(c,function(a){return a.collection}));for(var h=f.map(c,function(a){return a.videos}),i=0;i<h.length;i++)d=d.concat(h[i]);s.insert(d)}function l(){var a="/domain/mecanex/user/"+t+"/collection";return p.create(a,"bart",2).retrieve().$promise.then(function(a){return a})}function m(a,b){var c=[];if(void 0===a)return c;if(!angular.isArray(a)){var d=[];d.push(a),a=d}return angular.forEach(a,function(a){var d=[];angular.copy(u,d),void 0!==a.properties.annotationsfile&&(d[0].processed=!0,d[0].file=a.properties.annotationsfile),void 0!==a.properties.editenrichmenturl&&(d[1].processed=!0,d[1].file="",d[1].url=a.properties.editenrichmenturl),void 0!==a.properties.editorialurl&&(d[2].processed=!0,d[2].url=a.properties.editorialurl),c.push({_id:"/domain/mecanex/user/"+t+"/collection/"+b+"/video/"+a._id,name:a.properties.TitleSet_TitleSetInEnglish_title,description:a.properties.summaryInEnglish,img:a.properties.screenshot,refer:a._referid,categories:void 0===a.properties.categories?[]:n(a.properties.categories.split(",")),duration:a.properties.TechnicalInformation_itemDuration,steps:d,colId:b})}),c}function n(a){var b=[];return angular.forEach(a,function(a){for(var c=0;c<v.length;c++)if(v[c].icon===a){b.push(v[c]);break}}),b}var o,p=new e,q=c.db("Mecanex"),r=q.collection("collections"),s=q.collection("collection-videos"),t=g.get("smithersId"),u=f.values(h),v=f.values(i);return o=j(),{query:function(a){a=a?a:{};var c=a.query?a.query:{},d=a.settings?a.settings:{page:0,limit:10},e=b.defer();return o.then(function(){var a=r.find(c,{$page:d.page-1,$limit:d.limit});e.resolve({totalItems:a.$cursor.records?a.$cursor.records:a.length,itemsPerPage:d.limit,page:d.page,items:a})}),e.promise},queryVideos:function(a){a=a?a:{};var c=a.query?a.query:{},d=a.settings?a.settings:{page:1,limit:10},e=b.defer();return o.then(function(){var a=s.find(c,{$page:d.page-1,$limit:d.limit});e.resolve({totalItems:a.$cursor.records?a.$cursor.records:a.length,itemsPerPage:d.limit,page:d.page,items:a})}),e.promise},create:function(a){return b(function(b,c){var e=!1,f={};if(a.name&&""!==a.name||(e=!0,f.name="Name is required!"),a.description&&""!==a.description||(e=!0,f.description="Description is required!"),e)c(f);else{var g="/domain/mecanex/user/"+t+"/collection",h={properties:[{title:a.name},{description:a.description}]};p.create(g,"bart").save(h).$promise.then(function(c){var e=c.status.properties.uri,f=e.substring(e.lastIndexOf("/")+1);r.insert({_id:f,name:a.name,description:a.description,amountVideos:0,img:"images/collections/no-thumb.451751f3.png"}),d.go(d.current,{},{reload:!0,inherit:!0,notify:!0}),b()})}})},addVideoToCollection:function(a,b,c){var e={};angular.copy(a,e),e.colId=b,e._id=c,q.collection("collections"),s.insert(e),r.update({_id:b},{$inc:{amountVideos:1}});var g=r.find({_id:b});1===g[0].amountVideos&&r.update({_id:b},{img:e.img}),g=s.find({colId:b});var h=f.union.apply({},f.map(g,function(a){return f.map(a.categories,function(a){return a.name})}));r.update({_id:b},{categories:h}),d.go(d.current,{},{reload:!0,inherit:!0,notify:!0})},removeVideoFromCollection:function(a,b){s.remove({$and:[{_id:a},{colId:b}]}),r.update({_id:b},{$inc:{amountVideos:-1}});var c=r.find({_id:b});0===c[0].amountVideos&&r.update({_id:b},{img:"images/collections/no-thumb.451751f3.png"}),c=s.find({colId:b});var e=f.union.apply({},f.map(c,function(a){return f.map(a.categories,function(a){return a.name})}));r.update({_id:b},{categories:e}),d.go(d.current,{},{reload:!0,inherit:!0,notify:!0})}}}]),angular.module("mecanexAdminApp").factory("RandomCollections",["RandomData","$q","$fdb","chance",function(a,b,c,d){var e=c.db("Mecanex"),f=e.collection("random-collections");return{query:function(c){return b(function(b){b(a.queryCollections(c))})},create:function(a){return b(function(b,c){var e=!1,g={};a.name&&""!==a.name||(e=!0,g.name="Name is required!"),a.description&&""!==a.description||(e=!0,g.description="Description is required!"),e?c(g):(a._id=d.guid(),a.img="https://unsplash.it/320/180/?random&i="+d.integer({min:10,max:20}),a.amountVideos=0,a.created=new Date,f.insert(a),b(a))})},queryVideos:function(c){return b(function(b){b(a.queryCollectionVideos(c))})}}}]),angular.module("mecanexAdminApp").controller("ApplicationController",["$scope","USER_ROLES","AuthService",function(a,b,c){a.currentUser=null,a.userRoles=b,a.isAuthorized=c.isAuthorized,a.setCurrentUser=function(b){a.currentUser=b}}]),angular.module("mecanexAdminApp").controller("HeaderController",["$scope","Session","$log","$state",function(a,b,c,d){a.currentUser=b.get("userId"),a.status={isopen:!1},a.toggled=function(a){c.log("Dropdown is now: ",a)},a.logout=function(){b.destroy(),d.go("login.logout")}}]),angular.module("mecanexAdminApp").controller("LoginController",["$scope","$rootScope","AUTH_EVENTS","AuthService","$state",function(a,b,c,d,e){a.loginFailed=!1,a.credentials={username:"",password:""},a.login=function(f,g){d.login(f).then(function(d){a.loginFailed=!1,b.$broadcast(c.loginSuccess),a.setCurrentUser(d),e.go(g)},function(){a.loginFailed=!0,b.$broadcast(c.loginFailed)})}}]),angular.module("mecanexAdminApp").controller("CollectionsCarouselCtrl",["$scope","$uibModal","$stateParams","Collections",function(a,b,c,d){a.cols=[],a.colsPerSlide=4,a.curSlide=0,a.editCol=c.editColId,a.editTitle="",a.find=function(){d.query().then(function(b){b.items.unshift(null),a.cols=b.items,angular.forEach(b.items,function(b){null!==b&&b._id===a.editCol&&(a.editTitle=b.name)})})},a.find()}]),angular.module("mecanexAdminApp").controller("CollectionsListCtrl",["$scope","$state","Collections","VIDEO_CATEGORIES","_",function(a,b,c,d,e){a.items=[],a.totalItems=0,a.currentPage=1,a.limit=10,a.maxPages=5,a.formOpen=!1,a.newCollection={},a.newCollectionErr=null,a.icons=e.object(e.map(e.values(d),function(a){return[a.name,a.icon]}));var f={};a.toggleForm=function(){a.formOpen=!a.formOpen,a.formOpen||(a.newCollectionErr={},a.newCollection={})},a.submitForm=function(){c.create(a.newCollection).then(function(){a.newCollection={},a.newCollectionErr={},a.toggleForm(),a.setPage(1)},function(b){a.newCollectionErr=b})},a.setPage=function(b){a.currentPage=b,c.query({query:f,settings:{page:a.currentPage,limit:a.limit}}).then(function(b){a.totalItems=b.totalItems,a.currentPage=b.page,a.items=b.items})},a.pageChanged=function(){a.setPage(a.currentPage)},a.setPage(1)}]),angular.module("mecanexAdminApp").controller("VideosListCtrl",["$scope","$q","$uibModal","$log","$stateParams","CollectionVideos","ExternalVideos","SpringfieldResource","Session","Collections",function(a,b,c,d,e,f,g,h,i,j){function k(a,c){var d=a.fsxml.video.rawvideo.properties.mount,e=a.fsxml.video.rawvideo._id,f=a.fsxml.video.rawvideo.properties.extension;d.indexOf(",")>=0&&(d=d.substring(0,d.indexOf(","))),-1===d.indexOf("http")&&(d="http://"+d+".noterik.com/progressive/"+d+c+"/rawvideo/"+e+"/raw."+f),d=d.replace("mecanex","euscreenxl"),d=d.replace("luce","eu_luce");var g=d.substring(d.indexOf("progressive")+11),h=b.defer();return l.create("http://mecanex.noterik.com/api/mdbticket"+g).retrieve().$promise.then(function(a){h.resolve({videoUri:d+"?ticket="+a.fsxml.properties.ticket})}),h.promise}var l=new h,m=i.get("smithersId");a.items=[],a.totalItems=0,a.currentPage=1,a.limit=10,a.maxPages=5,a.col=e.colId?e.colId:null,a.editCol=e.editColId,a.selectedVideoId=null,a.smithersUser=m;var n="repository"===a.col?g:f,o=a.col?{colId:a.col}:{colId:a.editCol};a.setPage=function(b){a.currentPage=b,n.query({query:o,settings:{page:a.currentPage,limit:a.limit}}).then(function(b){a.totalItems=b.totalItems,a.currentPage=b.page,a.items=b.items})},a.pageChanged=function(){a.setPage(a.currentPage)},a.playVideo=function(b){a.selectedVideoId=b,l.create(a.items[b].refer,"bart",1).retrieve().$promise.then(function(d){k(d,a.items[b].refer).then(function(b){a.videoUri=b.videoUri,c.open({animation:!0,templateUrl:"views/player-dialog.html",controller:"PlayerDialogCtrl",scope:a,windowClass:"app-modal-window",size:"lg"})})})},a.actions=e.colId?[{description:"Add to collection",action:"addVideo",icon:"plus"}]:[{description:"Remove from collection",action:"removeVideo",icon:"minus"}],a.setPage(1),a.addVideo=function(b,c){var d="/domain/mecanex/user/"+m+"/collection/"+a.editCol+"/video",e={attributes:[{referid:b}]};l.create(d,"bart").save(e).$promise.then(function(b){var d=b.status.properties.uri;j.addVideoToCollection(a.items[c],a.editCol,d)})},a.removeVideo=function(b){l.create(b,"bart").remove().$promise.then(function(){j.removeVideoFromCollection(b,a.editCol)})}}]),angular.module("mecanexAdminApp").controller("PlayerDialogCtrl",["$scope","$uibModalInstance","SpringfieldResource",function(a,b,c){var d=new c;a.playerDialogVideo=a.items[a.selectedVideoId],a.videoUri=a.videoUri,a.close=function(){b.close()},a.add=function(b){var c="/domain/mecanex/user/"+a.smithersUser+"/collection/"+a.editCol+"/video",e={attributes:[{referid:b}]};d.create(c,"bart").save(e)},a["delete"]=function(b){var c="/domain/mecanex/user/"+a.smithersUser+"/collection/"+a.editCol+"/video/"+b;d.create(c,"bart").remove()}}]),angular.module("mecanexAdminApp").controller("CollectionViewCtrl",["$scope","$q","$uibModal","$state","$stateParams","CollectionVideos","VIDEO_CATEGORIES","_","SpringfieldResource","Session",function(a,b,c,d,e,f,g,h,i,j){function k(a,c){var d=a.fsxml.video.rawvideo.properties.mount,e=a.fsxml.video.rawvideo._id,f=a.fsxml.video.rawvideo.properties.extension;d.indexOf(",")>=0&&(d=d.substring(0,d.indexOf(","))),-1===d.indexOf("http")&&(d="http://"+d+".noterik.com/progressive/"+d+c+"/rawvideo/"+e+"/raw."+f),d=d.replace("mecanex","euscreenxl"),d=d.replace("luce","eu_luce");var g=d.substring(d.indexOf("progressive")+11),h=b.defer();return m.create("http://mecanex.noterik.com/api/mdbticket"+g).retrieve().$promise.then(function(a){h.resolve({videoUri:d+"?ticket="+a.fsxml.properties.ticket})}),h.promise}function l(){console.log("triggering processing"),m.create("http://mecanex.noterik.com/api/mdbprocess/domain/mecanex/user/"+a.smithersUser+"/collection/"+e.colId+"/video").retrieve()}var m=new i;a.items=[],a.totalItems=0,a.currentPage=1,a.limit=10,a.maxPages=5,a.formOpen=!1,a.selectedVideoId=null,a.smithersUser=j.get("smithersId"),a.categories=h.values(g),a.popOverVideo=null,a.setPopoverVideo=function(b){a.popOverVideo=b},a.toggleCategory=function(a,b){var c="",d=!1;angular.forEach(a.categories,function(e,f){e.icon===b.icon?d=!0:c+=""===c?a.categories[f].icon:","+a.categories[f].icon}),d||(c+=","+b.icon,m.create(a.refer+"/properties/categories","bart",1).update(c).$promise.then(function(){a.categories.push(b)}))},a.icons=h.object(h.map(h.values(g),function(a){return[a.name,a.icon]})),a.setPage=function(b){a.currentPage=b;var c={colId:e.colId};f.query({query:c,settings:{page:a.currentPage,limit:a.limit}}).then(function(b){a.totalItems=b.totalItems,a.currentPage=b.page,a.items=b.items})},a.playVideo=function(b){a.selectedVideoId=b,m.create(a.items[b].refer,"bart",1).retrieve().$promise.then(function(d){k(d,a.items[b].refer).then(function(b){a.videoUri=b.videoUri,c.open({animation:!0,templateUrl:"views/player-dialog.html",controller:"PlayerDialogCtrl",scope:a,windowClass:"app-modal-window",size:"lg"})})})},a.removeCategory=function(a,b){var c="",d=-1;angular.forEach(a.categories,function(e,f){e.icon===b?d=f:c+=""===c?a.categories[f].icon:","+a.categories[f].icon}),a.categories.splice(d,1),""!==c?m.create(a.refer+"/properties/categories","bart",1).update(c):m.create(a.refer+"/properties/categories","bart",1)["delete"]()},a.handleStep=function(b,f){"annotation"===f.icon&&f.processed&&(a.annotationsUrl="http://mecanex.noterik.com/annotations/"+f.file,c.open({animation:!0,templateUrl:"views/annotations-dialog.html",controller:"AnnotationsDialogCtrl",scope:a,windowClass:"app-modal-window",size:"lg"})),"enrichment"===f.icon&&f.processed&&d.go("pages.content-enrichments",{colId:e.colId,vidId:b._id.substr(b._id.lastIndexOf("/")+1)}),"editorial"===f.icon&&f.processed&&d.go("pages.editorial-tool",{colId:e.colId,vidId:b._id.substr(b._id.lastIndexOf("/")+1)})},a.pageChanged=function(){a.setPage(a.currentPage)},a.setPage(1),l()}]),angular.module("mecanexAdminApp").controller("ContentEnrichmentsCtrl",["$scope","$stateParams","Session","SpringfieldResource",function(a,b,c,d){var e=new d,f=c.get("smithersId");a.collection=b.colId,a.video=b.vidId;var g="/domain/mecanex/user/"+f+"/collection/"+a.collection+"/video/"+a.video;e.create(g,"bart",1).retrieve().$promise.then(function(b){a.videoTitle=b.fsxml.video.properties.TitleSet_TitleSetInEnglish_title,a.contentenrichmenturl=b.fsxml.video.properties.editenrichmenturl})}]),angular.module("mecanexAdminApp").controller("EditorialToolCtrl",["$scope","$stateParams","Session","SpringfieldResource",function(a,b,c,d){var e=new d,f=c.get("smithersId");a.collection=b.colId,a.video=b.vidId;var g="/domain/mecanex/user/"+f+"/collection/"+a.collection+"/video/"+a.video;e.create(g,"bart",1).retrieve().$promise.then(function(b){a.videoTitle=b.fsxml.video.properties.TitleSet_TitleSetInEnglish_title,a.editorialurl=b.fsxml.video.properties.editorialurl})}]),angular.module("mecanexAdminApp").controller("AnnotationsDialogCtrl",["$scope","$uibModalInstance",function(a,b){a.close=function(){b.close()}}]),angular.module("mecanexAdminApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/annotations-dialog.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="close()">&times;</button> <h3 class="modal-title">Annotations</h3> </div> <div class="modal-body" style="min-height: 650px"> <iframe ng-src="{{annotationsUrl | trusted}}" frameborder="0" style="min-height: 600px" class="col-sm-12"> </div>'),a.put("views/collection.html",'<div class="row"> <div class="navbar navbar-default"> <div class="col-sm-3"> <form class="navbar-form navbar-input-group" role="search"> <div class="form-group"> <input type="text" class="form-control" placeholder="Search"> </div> <button type="submit" class="btn btn-default"><i class="glyphicon glyphicon-search"></i></button> </form> </div> <div class="col-sm-6"> <form class="text-center navbar-form navbar-input-group paging" role="pagination"> <div class="form-group"> <uib-pagination max-size="maxPages" boundary-links="true" boundary-link-numbers="true" rotate="true" total-items="totalItems" ng-model="currentPage" class="pagination-sm" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChanged()"></uib-pagination> </div> </form> </div> <div class="col-sm-3"> </div> </div> </div>'),a.put("views/collection.view.html",'<section class="items"> <div class="row"> <div class="navbar navbar-default"> <div class="col-sm-3"> <form class="navbar-form navbar-input-group" role="search"> <div class="form-group"> <div class="input-group search"> <input type="text" class="form-control" placeholder="Search"> <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div> </div> </div> </form> </div> <div class="col-sm-6"> <form class="text-center navbar-form navbar-input-group paging" role="pagination"> <div class="form-group"> <uib-pagination max-size="maxPages" ng-hide="totalItems <= limit" boundary-links="true" boundary-link-numbers="true" rotate="true" total-items="totalItems" ng-model="currentPage" class="pagination-sm" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChanged()"></uib-pagination> </div> </form> </div> <div class="col-sm-3"> <div class="item-actions"> <button ng-repeat="action in actions" class="item-action btn btn-default round-icon-button"> <span class="{{action.iconClass}}"></span> </button> </div> </div> </div> </div> <div class="row"> <div class="items-list col-sm-12"> <div class="item row" ng-repeat="(key,video) in items track by $index"> <div class="container-fluid"> <div class="col-sm-12"> <div class="toggle"> <a href ng-click="video.expanded = video.expanded ? false : true"> <span class="glyphicon glyphicon-chevron-down"></span> </a> </div> <div class="row basic-info"> <div class="item-thumb"> <a href ng-click="playVideo($index)"> <img class="fill image-responsive" ng-src="{{video.img}}" alt="{{video.name}}"> </a> </div> <div class="item-information"> <div class="row fill-height"> <div class="col-sm-5"> <div class="item-descriptions"> <h3>{{video.name}}</h3> <p>{{video.description}}</p> </div> </div> <div class="col-sm-3 fill-height"> <div class="item-actions"> <button ng-repeat="step in video.steps | reverse" title="{{step.name}}" class="item-action btn btn-default round-icon-button" ng-click="handleStep(video,step)"> <span ng-if="step.processed == true" class="svg-icon svg-icon-{{step.icon}}-active"></span> <span ng-if="step.processed == false" class="svg-icon svg-icon-{{step.icon}}"></span> </button> </div> </div> <div class="col-sm-4 fill-height"> <div class="item-categories item-actions"> <button class="item-action btn btn-default round-icon-button" ng-click="setPopoverVideo(video)" uib-popover-template="\'views/popovers/video-categories.html\'" popover-title="Categories" popover-append-to-body="true" popover-placement="left" popover-trigger="outsideClick"> <span class="svg-icon svg-icon-add"></span> </button> <div class="seperator"></div> <button ng-repeat="category in video.categories" title="{{category.name}}" class="item-action btn btn-default round-icon-button" ng-click="removeCategory(video, category.icon)"> <span class="png-icon png-icon-{{icons[category.name]}}"></span> </button> </div> </div> </div> </div> </div> <div class="row extra-info" uib-collapse="!video.expanded"> <div class="arrow"> </div> <div class="contents container-fluid"> <div class="row"> <div class="col-md-1"> <label for="video-{{video._id}}-name">Name:</label> </div> <div class="col-md-11"> <span id="video-{{video._id}}-name" ng-bind="video.name"></span> </div> </div> <div class="row"> <div class="col-md-1"> <label for="video-{{video._id}}-duration">Duration:</label> </div> <div class="col-md-11"> <span id="video-{{video._id}}-duration" ng-bind="video.duration | date: \'H:mm:ss\'"></span> </div> </div> <div class="row"> <div class="col-md-1"> <label for="video-{{video._id}}-categories">Categories:</label> </div> <div class="col-md-11"> <span id="video-{{video._id}}-categories">{{video.categories | pluck: \'name\' | joinBy: \'; \'}}</span> </div> </div> <div class="row"> <div class="col-md-1"> <label for="video-{{video._id}}-categories">Description:</label> </div> <div class="col-md-11"> <p>{{video.description}}</p> </div> </div> </div> </div> </div> </div> </div> </div> </div> <div class="row"> <div class="navbar navbar-default"> <div class="col-sm-3"> &nbsp; </div> <div class="col-sm-6"> <form class="text-center navbar-form navbar-input-group paging" role="pagination"> <div class="form-group"> <uib-pagination max-size="maxPages" ng-hide="totalItems <= limit" boundary-links="true" boundary-link-numbers="true" rotate="true" total-items="totalItems" ng-model="currentPage" class="pagination-sm" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChanged()"></uib-pagination> </div> </form> </div> <div class="col-sm-3"> <div class="item-actions"> <button ng-repeat="action in actions" class="item-action btn btn-default round-icon-button"> <span class="{{action.iconClass}}"></span> </button> </div> </div> </div> </div> </section>'),
a.put("views/collections.edit.html",'<div ui-view></div> <div ui-view="list"></div>'),a.put("views/collections.edit.list.html",'<div class="row"> <div class="navbar navbar-default"> <div class="col-sm-12"> <h3><a ui-sref="pages.list-collections">Edit collection {{editTitle}}</a></h3> </div> </div> <div class="col-md-12 collections"> <div class="row"> <uib-carousel active="active" interval="myInterval" no-wrap="noWrapSlides"> <uib-slide ng-repeat="block in cols | chunkBy: 4 track by $index" index="$index"> <div class="collections-list"> <!-- The collections --> <div class="collection col-sm-3" ng-repeat="col in block"> <div ng-if="col != null" class="collection-content sixteen-nine"> <div class="content"> <div class="collection-label"> {{col.name}} </div> <div class="collection-thumb"> <a ng-if="col._id == editCol" ui-sref="pages.edit-collection.default({editColId: col._id, slideIndex: $index})"> <img ng-src="{{col.img}}" class="fill img-responsive" alt="{{col.amountVideos}}"> </a> <a ng-if="col._id != editCol" ui-sref="pages.edit-collection.other-collection({colId: col._id, slideIndex: $index})"> <img ng-src="{{col.img}}" class="fill img-responsive" alt="{{col.amountVideos}}"> </a> </div> <div class="collection-counter"> <span class="badge">{{col.amountVideos}}</span> </div> </div> </div> <div ng-if="col == null" class="collection-content sixteen-nine"> <div class="content"> <div class="collection-label"> Repository </div> <div class="collection-thumb"> <a ui-sref="pages.edit-collection.other-collection({colId: \'repository\', slideIndex: $index})"> <div class="fill"><span> </span></div> </a> </div> <div class="collection-counter"> <span class="badge">{{col.amountVideos}}</span> </div> </div> </div> </div> </div> </uib-slide> </uib-carousel> </div> </div> </div>'),a.put("views/collections.list.html",'<section class="items"> <div class="row"> <div class="navbar navbar-default"> <div class="col-sm-3"> <form class="navbar-form navbar-input-group" role="search"> <div class="form-group"> <div class="input-group search"> <input type="text" class="form-control" placeholder="Search"> <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div> </div> </div> </form> </div> <div class="col-sm-6"> <form class="text-center navbar-form navbar-input-group paging" role="pagination"> <div class="form-group"> <uib-pagination max-size="maxPages" ng-hide="totalItems <= limit" boundary-links="true" boundary-link-numbers="true" rotate="true" total-items="totalItems" ng-model="currentPage" class="pagination-sm" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChanged()"></uib-pagination> </div> </form> </div> <div class="col-sm-3"> <div class="item-actions"> <button ng-repeat="action in actions" class="item-action btn btn-default round-icon-button"> <span class="{{action.iconClass}}"></span> </button> </div> </div> </div> </div> <div class="row"> <div class="items-list col-sm-12"> <div class="add-item item row" ng-show="!formOpen"> <div class="container-fluid"> <div class="col-sm-12"> <div class="row basic-info contents"> <div class="item-thumb"> <a href ng-click="toggleForm()"> <span class="svg-icon svg-icon-big-add"></span> </a> </div> </div> </div> </div> </div> <!-- Start Add Item form --> <div class="add-item-form item row" ng-show="formOpen"> <div class="container-fluid"> <div class="col-sm-12"> <div class="row basic-info"> <div class="item-thumb"> <a href ng-click="toggleForm()"> <span class="svg-icon svg-icon-big-add"></span> </a> </div> <div class="item-information"> <div class="container-fluid"> <div class="row contents"> <form class="form-horizontal col-md-12" ng-submit="submitForm()"> <div class="col-md-12"> <div class="form-group" ng-class="{\'has-warning\':newCollectionErr.name}"> <label for="collectionTitle">Title</label> <input type="text" class="form-control" id="newCollectionName" ng-model="newCollection.name"> <span id="collectionNameHelp" class="help-block" ng-bind="newCollectionErr.name"></span> </div> <div class="form-group" ng-class="{\'has-warning\':newCollectionErr.description}"> <label for="collectionDescription">Description</label> <textarea class="form-control" id="newCollectionDescription" ng-model="newCollection.description"></textarea> <span id="collectionDescriptionHelp" class="help-block" ng-bind="newCollectionErr.description"></span> </div> <div class="form-group pull-right"> <button type="button" class="btn btn-warning" ng-click="toggleForm()">Cancel</button> <button type="submit" class="btn btn-primary">Submit</button> </div> </div> </form> </div> </div> </div> </div> </div> </div> </div> <!-- End Add Item form --> <div class="item row" ng-repeat="col in items"> <div class="container-fluid"> <div class="col-sm-12"> <div class="row basic-info"> <a ui-sref="pages.view-collection({colId:col._id})"> <div class="item-thumb"> <img class="fill image-responsive" ng-src="{{col.img}}" alt="{{col.name}}"> </div> </a> <div class="item-information"> <div class="row fill-height"> <div class="col-sm-6"> <div class="item-descriptions"> <h3>{{col.name}}</h3> <span>{{col.description}}</span> </div> </div> <div class="col-sm-6 fill-height"> <div class="item-actions"> <button ui-sref="pages.edit-collection.default({editColId:col._id})" class="item-action btn btn-default round-icon-button"> <span class="svg-icon svg-icon-add"></span> </button> <div class="seperator"></div> <button ng-repeat="category in col.categories" title="{{category}}" class="item-action btn btn-default round-icon-button"> <span class="png-icon png-icon-{{icons[category]}}"></span> </button> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> <div class="row"> <div class="navbar navbar-default"> <div class="col-sm-3"> </div> <div class="col-sm-6"> <form class="text-center navbar-form navbar-input-group paging" role="pagination"> <div class="form-group"> <uib-pagination max-size="maxPages" ng-hide="totalItems <= limit" boundary-links="true" boundary-link-numbers="true" rotate="true" total-items="totalItems" ng-model="currentPage" class="pagination-sm" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChanged()"></uib-pagination> </div> </form> </div> <div class="col-sm-3"> </div> </div> </div>  </section>'),a.put("views/content.enrichments.html",'<div class="navbar navbar-default"> <div class="col-sm-12"> <h3 class="ng-binding"><a ui-sref="pages.view-collection({colId: collection})" href>{{videoTitle}}</a></h3> </div> </div> <div class="col-sm-12"> <div class="row"> <iframe ng-src="{{contentenrichmenturl | trusted}}" frameborder="0" style="min-height: 600px" class="col-sm-12"> </div> </div>'),a.put("views/editorial.tool.html",'<div class="navbar navbar-default"> <div class="col-sm-12"> <h3 class="ng-binding"><a ui-sref="pages.view-collection({colId: collection})" href>{{videoTitle}}</a></h3> </div> </div> <div class="col-sm-12"> <div class="row"> <iframe ng-src="{{editorialurl | trusted}}" frameborder="0" style="min-height: 600px" class="col-sm-12"> </div> </div>'),a.put("views/elements/header.html",'<div class="header" ng-controller="HeaderController"> <div class="navbar navbar-default" role="navigation"> <div class="container-fluid"> <div class="navbar-header"> <a class="navbar-brand" href="#/">MecanexAdmin</a> </div> <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"> <ul class="nav navbar-nav navbar-right"> <li class="dropdown" uib-dropdown on-toggle="toggled(open)"> <a href class="dropdown-toggle" uib-dropdown-toggle>Welcome {{currentUser}} <span class="caret"></span></a> <ul class="dropdown-menu" uib-dropdown-menu> <li><a href ng-click="logout()">Log out</a></li> <!--<li ng-if="col._id == editCol">User management</li>--> </ul> </li> </ul> </div> </div> </div> </div>'),a.put("views/login.default.html",'<div class="login-dialog"> <div class="login-dialog-header"> </div> <div class="container-fluid login-contents"> <div class="row"> <div class="col-md-1"> </div> <div class="col-md-10"> <div class="row title"> <div class="col-md-12"> <h1>Login</h1> </div> </div> <form ng-controller="LoginController" ng-submit="login(credentials, \'pages.list-collections\')" novalidate> <div class="row form"> <div class="col-md-12"> <div class="form-group" ng-class="{\'has-warning\': loginFailed}"> <input type="email" class="form-control" ng-model="credentials.username" id="UserEmail" placeholder="User e-mail address"> <br> <input type="password" class="form-control" ng-model="credentials.password" id="UserPassword" placeholder="Password"> <span ng-show="loginFailed" id="helpBlock" class="help-block">Incorrect email or password!</span> </div> </div> </div> <div class="row bottom"> <div class="col-md-9"> <div class="row"> <div class="col-md-12"> <div class="checkbox"> <label> <input type="checkbox">Keep me signed in </label> </div> </div> </div> <div class="row"> <div class="col-md-12"> <p>New to Mecanex? <b><a href="create">Create account</a></b></p> </div> </div> </div> <div class="col-md-3"> <button type="submit" class="btn btn-default">Sign in</button> </div> </div> </form> </div> <div class="col-md-1"> </div> </div> </div> </div>'),a.put("views/main.html",'<div class="jumbotron"> <h1>\'Allo, \'Allo!</h1> <p class="lead"> <img src="images/yeoman.8cb970fb.png" alt="I\'m Yeoman"><br> Always a pleasure scaffolding your apps. </p> <p><a class="btn btn-lg btn-success" ng-href="#/">Splendid!<span class="glyphicon glyphicon-ok"></span></a></p> </div> <div class="row marketing"> <h4>HTML5 Boilerplate</h4> <p> HTML5 Boilerplate is a professional front-end template for building fast, robust, and adaptable web apps or sites. </p> <h4>Angular</h4> <p> AngularJS is a toolset for building the framework most suited to your application development. </p> <h4>Karma</h4> <p>Spectacular Test Runner for JavaScript.</p> </div>'),a.put("views/pages/default.html",'<!-- Add your site or application content here --> <div ng-include src="\'views/elements/header.html\'"></div> <div class="container-fluid"> <div ui-view></div> </div> <div class="footer"> <div class="container"> <p><span class="glyphicon glyphicon-copyright-mark"></span> by Noterik B.V.</p> </div> </div>'),a.put("views/pages/logged-out.html",'<span style="color: white">You are now logged out. Click <a ui-sref="login.default">here</a> to log back in.</span>'),a.put("views/pages/login.html",'<!-- Add your site or application content here --> <div class="container-fluid login"> <div ui-view></div> </div>'),a.put("views/pages/not-allowed.html",'<span style="color: white">You\'re not allowed to visit this page!</span>'),a.put("views/player-dialog.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="close()">&times;</button> <h3 class="modal-title">{{playerDialogVideo.name}}</h3> </div> <div class="modal-body"> <video id="mecanexVideo" width="864" height="486" controls autoplay> <source ng-src="{{videoUri | trusted}}" type="video/mp4"> </source></video> </div>'),a.put("views/popovers/video-categories.html",'<div class="container-fluid"> <div class="row" ng-repeat="block in categories | chunkBy: 2 track by $index" index="$index"> <div class="col-md-6" ng-repeat="category in block"> <button class="item-action btn btn-default round-icon-button" title="{{category.name}}" ng-click="toggleCategory(popOverVideo, category)"> <span class="png-icon png-icon-{{category.icon}}" ng-class="{\'active\': pluck(popOverVideo.categories, \'name\').indexOf(category.name) >= 0}"></span> </button> </div> </div> </div>'),a.put("views/videos.list.html",'<section class="items"> <div class="row"> <div class="navbar navbar-default"> <div class="col-sm-3"> <form class="navbar-form navbar-input-group" role="search"> <div class="form-group"> <div class="input-group search"> <input type="text" class="form-control" placeholder="Search"> <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div> </div> </div> </form> </div> <div class="col-sm-6"> <form class="text-center navbar-form navbar-input-group paging" role="pagination"> <div class="form-group"> <uib-pagination max-size="maxPages" ng-hide="totalItems < limit" boundary-links="true" boundary-link-numbers="true" rotate="true" total-items="totalItems" ng-model="currentPage" class="pagination-sm" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChanged()"></uib-pagination> </div> </form> </div> <div class="col-sm-3"> </div> </div> </div> <div class="row"> <div class="items-list col-sm-12"> <div class="item row" ng-repeat="(key,video) in items"> <div class="container-fluid"> <div class="col-sm-12"> <div class="row basic-info contents"> <a href ng-click="playVideo(key)"> <div class="item-thumb"> <img class="fill image-responsive" ng-src="{{video.img}}" alt="{{video.name}}"> </div> </a> <div class="item-information"> <div class="row fill-height"> <div class="col-sm-8"> <div class="video-descriptions"> <h3>{{video.name}}</h3> <span>{{video.description}}</span> </div> </div> <div class="col-sm-4 fill-height"> <div class="item-actions" ng-repeat="action in actions"> <button ng-if="action.action == \'addVideo\'" class="item-action btn btn-default round-icon-button" ng-click="addVideo(video.refer, key)"> <span class="glyphicon glyphicon-{{action.icon}}"></span> </button> <button ng-if="action.action == \'removeVideo\'" class="item-action btn btn-default round-icon-button" ng-click="removeVideo(video._id)"> <span class="glyphicon glyphicon-{{action.icon}}"></span> </button> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> <div class="row"> <div class="navbar navbar-default"> <div class="col-sm-3"> </div> <div class="col-sm-6"> <form class="text-center navbar-form navbar-input-group paging" role="pagination"> <div class="form-group"> <uib-pagination max-size="maxPages" ng-hide="totalItems < limit" boundary-links="true" boundary-link-numbers="true" rotate="true" total-items="totalItems" ng-model="currentPage" class="pagination-sm" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChanged()"></uib-pagination> </div> </form> </div> <div class="col-sm-3"> </div> </div> </div>  </section>')}]);